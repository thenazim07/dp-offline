<template>
    <div
        ref="reference"
        class="overflow-hidden"
    >
        <div
            id="signature"
            :class="
                tailwindMerge(
                    'group flex w-fit cursor-pointer flex-col gap-[11px] overflow-hidden p-3 text-[#1E293B] hover:bg-slate-50',
                    {
                        'rounded-lg border border-[#136AFB]': bodysectionModalsEdit.signature,
                    },
                )
            "
            :style="generateStyle(signature?.styles)"
            @click="bodysectionModalsEdit.signature = true"
        >
            <div class="relative flex w-full justify-between">
                <svg
                    width="89"
                    height="51"
                    viewBox="0 0 89 51"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M13.964 50.0121C15.3823 47.9911 16.7787 45.9571 18.2315 43.9551C18.721 43.3187 19.2746 42.7213 19.8858 42.1701C20.0746 41.9911 20.4614 41.9761 20.7377 41.8591C20.9198 41.7924 21.0815 41.6897 21.2097 41.5591C23.7298 38.6014 26.8777 36.0897 30.4838 34.1591C32.8755 32.8677 35.3551 31.7035 37.9091 30.6731C40.3311 29.7363 42.8985 29.1143 45.529 28.8271C46.7981 28.5984 48.0527 28.3127 49.2877 27.9711C49.5629 27.868 49.8115 27.7181 50.0187 27.5301C52.0126 26.1411 53.9973 24.7411 56.005 23.3631C56.1411 23.2815 56.2396 23.1609 56.2832 23.0224C56.3268 22.8838 56.3127 22.7364 56.2433 22.6061C55.4501 22.6801 54.6639 22.7431 53.8787 22.8281C52.0195 23.0281 50.1603 23.2281 48.3057 23.4501C45.9066 23.7381 43.5155 24.0661 41.1153 24.3391C39.6429 24.5051 38.1566 24.5931 36.6808 24.7391C36.3862 24.7621 36.1013 24.8424 35.8473 24.9741C31.4854 27.4531 27.1419 29.9541 22.7765 32.4281C19.0063 34.5651 15.1889 36.6421 11.4405 38.8081C8.28161 40.6321 5.1906 42.5421 2.07543 44.4221C1.73007 44.6321 1.43191 44.9041 1.10151 45.1361C1.04027 45.1934 0.965103 45.2383 0.881465 45.2673C0.797826 45.2964 0.707803 45.3089 0.617903 45.304C0.528003 45.2991 0.440474 45.277 0.361649 45.2391C0.282825 45.2012 0.214664 45.1486 0.162117 45.0851C0.100378 45.0277 0.0543248 44.9589 0.0273672 44.8839C0.000409616 44.8089 -0.00675034 44.7296 0.00641091 44.6519C0.0195722 44.5742 0.052719 44.5 0.103393 44.435C0.154067 44.3699 0.220961 44.3156 0.299114 44.2761C0.67551 44.0209 1.0675 43.7835 1.47335 43.5651C4.57011 41.8651 7.68988 40.2001 10.7659 38.4651C17.4429 34.6831 24.1027 30.8651 30.7739 27.0651C31.9735 26.3811 33.1915 25.7251 34.4072 25.0551C34.4901 25.0101 34.5695 24.9551 34.7214 24.8631C34.0088 24.8921 33.3953 24.9101 32.7817 24.9441C30.4959 25.0358 28.2072 24.8336 25.9895 24.3441C24.553 23.9749 23.2499 23.291 22.2055 22.3581C21.563 21.7342 21.149 20.9582 21.0163 20.1291C20.9846 20.0075 20.993 19.8807 21.0405 19.7631C21.4288 18.6627 21.9893 17.6139 22.7063 16.6461C25.0314 14.0294 27.9525 11.8571 31.2874 10.2651C35.1357 8.30636 39.1148 6.54825 43.2036 5.00007C44.1844 4.62107 45.2193 4.34507 46.222 4.00607C46.4133 3.95268 46.5784 3.84489 46.6906 3.70007C46.7758 3.49473 46.9128 3.30856 47.0916 3.15519C47.2704 3.00182 47.4864 2.88514 47.7238 2.81371C47.9612 2.74227 48.2141 2.71789 48.4638 2.74235C48.7135 2.76681 48.9537 2.83949 49.1668 2.95507C49.3692 3.0272 49.5918 3.04463 49.8057 3.00507C53.0502 2.39304 56.2206 1.51546 59.2744 0.384065C60.3018 0.0601514 61.4007 -0.0557901 62.4875 0.0450678C58.3212 1.30207 54.3415 2.80507 50.0544 3.56007C50.1097 3.64507 50.1235 3.69407 50.1592 3.72007C52.4369 5.57218 53.9852 8.00038 54.5844 10.6601C54.9355 11.8301 55.3166 12.9941 55.6953 14.1991C56.8189 13.6721 57.9252 13.1281 59.0557 12.6251C66.019 9.53373 72.9842 6.44673 79.9513 3.36407C82.1386 2.39007 84.3202 1.39707 86.4695 0.358068C87.1265 0.069768 87.8688 -0.0383409 88.5981 0.0480662C77.7767 5.26407 66.4488 9.51806 55.7886 14.8771L57.025 21.8941C57.8422 21.9208 58.6469 21.7131 59.3147 21.3031C63.6444 18.8711 67.9396 16.3841 72.3833 14.1181C75.6251 12.4641 79.0603 11.0861 82.446 9.66107C83.6868 9.18023 84.9719 8.79054 86.2876 8.49607C86.824 8.40716 87.3747 8.40513 87.9119 8.49007C88.0443 8.50307 88.1422 8.76607 88.2573 8.91407C88.0945 8.99215 87.9196 9.04972 87.7381 9.08506C87.1849 9.06783 86.6311 9.09193 86.0827 9.15707C82.8892 9.88407 80.0745 11.3641 77.132 12.5971C71.1872 15.0861 65.7753 18.3341 60.2668 21.4471C60.1939 21.509 60.127 21.5758 60.0665 21.6471C60.4638 21.5565 60.8671 21.4867 61.2741 21.4381C62.1543 21.3677 63.038 21.336 63.9219 21.3431C64.1415 21.3321 64.36 21.3776 64.5499 21.4741C64.7398 21.5706 64.8927 21.7136 64.9893 21.8853C65.086 22.0569 65.1221 22.2496 65.0932 22.439C65.0643 22.6284 64.9716 22.8062 64.8267 22.9501C63.9268 24.1192 62.8054 25.1474 61.5101 25.9911C60.763 26.4611 60.0366 26.9571 59.3297 27.4721C59.1745 27.6182 59.0875 27.8093 59.0856 28.0081C59.1022 28.2985 59.1372 28.588 59.1904 28.8751C59.2411 29.4491 58.9774 29.7491 58.3247 29.7391C57.819 29.7123 57.3176 29.6416 56.8281 29.5281C56.6015 29.4701 56.3626 29.458 56.1297 29.4926C55.8968 29.5273 55.6761 29.6078 55.4847 29.7281C50.3963 32.8527 45.4607 36.1494 40.6778 39.6181C37.6559 41.8131 34.5016 43.8691 31.4117 45.9931C29.4646 47.3331 27.5225 48.6781 25.5854 50.0281H24.5194C24.554 49.9768 24.5958 49.9295 24.6438 49.8871C26.4089 48.6724 28.1764 47.4591 29.9462 46.2471C33.0514 44.1197 36.1597 41.9934 39.271 39.8681C43.4369 37.0194 47.6039 34.1724 51.772 31.3271C52.7448 30.6661 53.7659 30.0601 54.8193 29.3931C54.6634 29.3475 54.5031 29.314 54.3404 29.2931C52.9416 29.2581 51.5418 29.2501 50.1442 29.1931C49.6509 29.1538 49.1539 29.2165 48.6937 29.3758C48.2336 29.5352 47.8233 29.7868 47.4964 30.1101C47.265 30.3233 47.0075 30.5141 46.7286 30.6791C46.6048 30.7502 46.5057 30.8491 46.4416 30.9654C46.3775 31.0816 46.351 31.2108 46.3648 31.3391C46.3935 31.6481 46.3359 31.9586 46.1968 32.2441C46.0577 32.5297 45.8412 32.7818 45.5658 32.9791C44.7953 33.5011 43.8715 33.8248 42.8996 33.9131C42.5757 33.9452 42.2755 34.0766 42.0531 34.2837C41.8307 34.4908 41.7006 34.7601 41.6863 35.0431C41.6605 36.2616 41.2304 37.4477 40.4476 38.4591C39.9949 39.0229 39.3404 39.441 38.5858 39.648C37.8312 39.8551 37.019 39.8397 36.2756 39.6041C36.1765 39.5631 36.0645 39.5521 35.9574 39.573C35.8504 39.5938 35.7545 39.6453 35.685 39.7191C34.6558 40.6131 33.5864 41.4741 32.586 42.3901C30.1293 44.6361 27.7025 46.9061 25.2631 49.1661C24.9488 49.4561 24.6288 49.7381 24.3099 50.0261H23.3509C24.1683 49.3021 25.0018 48.5911 25.8007 47.8541C28.2344 45.6081 30.6604 43.3561 33.0787 41.0981C33.7751 40.4511 34.4659 39.7981 35.1508 39.1581C35.1635 39.1641 35.0887 39.1251 35.0104 39.0921C33.8534 38.5981 32.685 38.1211 31.5406 37.6031C31.0111 37.3641 30.5287 37.0441 30.0211 36.7661C29.7574 36.6211 29.5882 36.6841 29.5272 36.9551C29.4973 37.0901 29.4454 37.2221 29.4293 37.3551C29.2086 39.3009 28.5061 41.1822 27.3698 42.8701C27.1396 43.2151 26.9231 43.5701 26.6906 43.9121C26.3096 44.4781 25.9607 45.0681 25.5198 45.5981C25.0513 46.1601 24.4734 46.1451 23.9933 45.5921C23.4281 44.9421 22.9284 44.2501 22.3528 43.6071C21.993 43.2536 21.6085 42.9196 21.2016 42.6071C20.626 43.2711 20.1322 43.8531 19.6222 44.4221C18.1332 46.1258 16.9458 48.0133 16.0995 50.0221H15.3546L17.1114 46.5521L17.0596 46.5261L14.7146 50.0261L13.964 50.0121ZM46.313 4.59906C46.1679 4.64207 46.0137 4.67507 45.8698 4.73007C43.4269 5.65507 40.9483 6.51607 38.5527 7.52507C34.3477 9.16304 30.3885 11.2407 26.7631 13.7121C24.6728 15.1296 23.0325 16.9863 21.9971 19.1071C21.7653 19.5845 21.7123 20.1131 21.8456 20.6182C21.9788 21.1232 22.2916 21.579 22.7396 21.9211C23.7085 22.8556 24.9844 23.5091 26.3947 23.7931C28.0254 24.0613 29.673 24.245 31.3288 24.3431C32.4453 24.3793 33.5632 24.3512 34.6754 24.2591C35.2028 24.2814 35.7294 24.2029 36.218 24.0291C39.895 22.1791 43.5363 20.2781 47.1959 18.4001C49.0839 17.4311 50.9834 16.4791 52.906 15.5051C52.8035 15.3311 52.7218 15.1611 52.6124 15.0051C51.1319 12.9431 49.6641 10.8741 48.1584 8.82607C47.1775 7.55756 46.545 6.1104 46.3095 4.59607L46.313 4.59906ZM45.6683 29.3991C38.3098 29.9941 25.9987 36.2181 21.8129 41.9281L24.5137 45.1871C24.7784 44.9071 24.9741 44.6871 25.1791 44.4871C26.7733 42.9101 27.8881 41.0119 28.422 38.9651C28.6258 38.1741 28.7386 37.3651 28.9677 36.5781C28.988 36.4308 29.0551 36.2913 29.1614 36.1753C29.2677 36.0592 29.4091 35.9711 29.5697 35.9208C29.7303 35.8705 29.9039 35.8599 30.071 35.8904C30.2381 35.9208 30.3922 35.991 30.5161 36.0931C30.9432 36.3381 31.3219 36.6541 31.7525 36.8881C32.6365 37.5337 33.7356 37.9161 34.8884 37.9791C35.0624 37.9945 35.2286 38.0501 35.3696 38.1401C35.6125 38.2611 35.8393 38.4041 36.0799 38.5401C37.6916 37.1691 39.2756 35.8211 40.8516 34.4641C40.9584 34.3497 41.0241 34.2106 41.0404 34.0641C41.0774 33.7788 41.228 33.5137 41.4662 33.3146C41.7044 33.1156 42.0151 32.9951 42.3447 32.9741C42.5479 32.9548 42.7411 32.8873 42.9031 32.7791C43.699 32.1864 44.4814 31.5811 45.2504 30.9631C45.3884 30.8378 45.4806 30.6798 45.5152 30.5091C45.5866 30.1471 45.613 29.7831 45.6648 29.3961L45.6683 29.3991ZM37.6029 23.9571L37.6444 24.0971L56.302 21.9551L53.3215 15.9781L37.6029 23.9571ZM53.5921 15.1861C53.9605 15.0111 54.3438 14.8191 54.7364 14.6451C54.7858 14.6323 54.8313 14.6103 54.8699 14.5806C54.9084 14.5508 54.9389 14.5141 54.9594 14.473C54.9798 14.4319 54.9896 14.3874 54.988 14.3427C54.9865 14.2979 54.9737 14.254 54.9505 14.2141C54.4198 12.5331 54.0157 10.8141 53.3722 9.16907C52.7607 7.4934 51.7348 5.95413 50.3664 4.65907C50.0734 4.29391 49.6311 4.03959 49.1297 3.94798C48.6282 3.85637 48.1054 3.93437 47.6679 4.16607C47.4078 4.28007 47.1902 4.36606 47.2075 4.64106C47.1781 5.03174 47.2106 5.42408 47.3042 5.80707C47.5587 6.54118 47.9062 7.24851 48.3403 7.91607C50.0383 10.3421 51.8077 12.7341 53.5921 15.1861ZM58.7668 27.0021C58.8197 26.9926 58.8714 26.9786 58.921 26.9601C60.9368 25.7222 62.7307 24.2321 64.2442 22.5381C64.4917 22.2631 64.387 22.0771 64.0704 21.9631C63.8766 21.8899 63.6654 21.858 63.4545 21.8701C62.2446 21.9781 61.0369 22.1611 59.8293 22.2111C58.945 22.2722 58.1155 22.6076 57.4924 23.1561L58.7668 27.0021ZM57.0802 24.0601C57.0388 24.2721 57.0215 24.3771 56.9974 24.4821C56.9732 24.5871 56.9409 24.6891 56.9202 24.7941C56.8111 25.5154 56.45 26.1903 55.8856 26.7278C55.3211 27.2653 54.5805 27.6396 53.7636 27.8001C52.7655 28.0351 51.7329 28.1641 50.7163 28.3421C50.3779 28.4021 50.0406 28.4671 49.7033 28.5281C50.0757 28.6 50.457 28.6315 50.8384 28.6221C52.0195 28.6481 53.2018 28.6784 54.3853 28.7131C54.8757 28.7271 55.449 28.9031 55.8381 28.7411C56.6634 28.3502 57.4572 27.9112 58.2142 27.4271L57.0802 24.0601ZM56.3757 23.8341L50.9535 27.6091C55.0887 27.3631 56.188 26.0961 56.3711 23.8331L56.3757 23.8341ZM40.8447 35.2861L36.8972 38.8861C37.339 39.0455 37.8248 39.0897 38.295 39.0132C38.7653 38.9366 39.1997 38.7427 39.545 38.4551C40.441 37.5882 40.9079 36.4497 40.8447 35.2861ZM55.9843 19.5861L55.1209 15.1401L53.8707 15.7521L55.9843 19.5861ZM57.0204 28.8481C57.3761 28.9021 57.6443 28.9481 57.9149 28.9801C58.4145 29.0421 58.6056 28.8801 58.5066 28.4451C58.4703 28.316 58.4257 28.1888 58.373 28.0641L57.0204 28.8481ZM44.0232 32.7141L44.1257 32.8141C44.6334 32.5301 45.2826 32.3771 45.4691 31.6031L44.0232 32.7141Z"
                        fill="black"
                    />
                </svg>
                <PrescriptionEditPrescriptionLayoutNavigationNavArrow
                    v-model:model-value="bodySectionFormData"
                    section-key-name="signature"
                />
            </div>

            <!-- list -->
            <div
                class="flex items-start justify-start gap-3"
                :style="generateStyle(signature?.list?.styles)"
            >
                <!-- <div class="w-[1.5%]">
                <div class="h-1.5 w-1.5 text-sm font-bold">1.</div>
            </div> -->

                <div class="flex flex-grow items-start justify-normal">
                    <div class="flex w-full flex-grow flex-col items-start gap-[9px]">
                        <p class="text-sm font-bold">Dr. Shankhamay Ghosh</p>
                        <p class="cursor-pointer text-sm text-[#1E293B]">Emergency Medical Officer</p>
                        <p class="cursor-pointer text-sm text-[#1E293B]">
                            Z.H.Sikder Womens Medical Collage & Hospital
                        </p>
                        <!-- <p class="text-xs">This is note</p> -->
                    </div>
                </div>
            </div>

            <!-- modal -->
            <PrescriptionEditPrescriptionLayoutModalsLayoutEditSignatureModal
                v-if="bodysectionModalsEdit.signature"
                ref="floating"
                v-model:model-value="signature"
                :style="floatingStyles"
                class="z-50"
            />
        </div>
    </div>
</template>
<script setup lang="ts">
const LayoutsStore = useLayoutsStore();

const { bodySectionFormData, bodysectionModalsEdit } = storeToRefs(LayoutsStore);

const reference = ref(null);
const floating = ref(null);

const currentColumnIndex = computed(() =>
    Object.keys(bodySectionFormData.value.body.columns.column0.items).includes('signature') ? 0 : 1,
);

const { floatingStyles } = useFloatingElementPrescriptionLayout(reference, floating, currentColumnIndex);

const { generateStyle } = useGenerateStyle();

onClickOutside(floating, () => (bodysectionModalsEdit.value.signature = false));

const signature = computed({
    // getter
    get() {
        return (
            bodySectionFormData.value.body.columns.column0.items.signature ??
            bodySectionFormData.value.body.columns.column1.items.signature
        );
    },
    // setter
    set(newValue) {
        // Note: we are using destructuring assignment syntax here.
        if (bodySectionFormData.value.body.columns.column0.items.signature)
            bodySectionFormData.value.body.columns.column0.items.signature = newValue;

        if (bodySectionFormData.value.body.columns.column1.items.signature)
            bodySectionFormData.value.body.columns.column1.items.signature = newValue;
    },
});
</script>
